(()=>{"use strict";async function e(e){try{const t=new FormData;t.append("file",e.file),t.append("type",e.type);const o=await chrome.storage.sync.get(["userToken"]),a=await fetch("https://ap-southeast-1.run.claw.cloud/api/upload",{method:"POST",headers:{Authorization:`Bearer ${o.userToken}`},body:t});if(!a.ok)throw new Error(`Upload failed: ${a.statusText}`);return await a.json()}catch(e){throw console.error("文件上传失败:",e),e}}async function t(e){try{const t=await chrome.storage.sync.get(["userToken"]),o=await fetch("https://ap-southeast-1.run.claw.cloud/api/submissions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.userToken}`},body:JSON.stringify(e)});if(!o.ok)throw new Error(`Save failed: ${o.statusText}`);return await o.json()}catch(e){throw console.error("保存作业失败:",e),e}}chrome.runtime.onInstalled.addListener(()=>{console.log("AI微积分助教插件已安装"),chrome.storage.sync.set({isLoggedIn:!1,userProfile:null,settings:{autoGrading:!0,showHints:!0,language:"zh-CN"}}),chrome.contextMenus&&chrome.contextMenus.create({id:"uploadHomework",title:"上传作业到AI助教",contexts:["page"]})}),chrome.contextMenus&&chrome.contextMenus.onClicked&&chrome.contextMenus.onClicked.addListener((e,t)=>{"uploadHomework"===e.menuItemId&&t?.id&&chrome.sidePanel&&chrome.sidePanel.open({tabId:t.id})}),chrome.runtime.onMessage.addListener((o,a,s)=>{switch(console.log("Background收到消息:",o),o.type){case"UPLOAD_FILE":return e(o.data).then(e=>s({success:!0,data:e})).catch(e=>s({success:!1,error:e.message})),!0;case"GET_USER_STATUS":return chrome.storage.sync.get(["isLoggedIn","userProfile"],e=>{s({success:!0,data:e})}),!0;case"SAVE_SUBMISSION":return t(o.data).then(e=>s({success:!0,data:e})).catch(e=>s({success:!1,error:e.message})),!0;default:s({success:!1,error:"Unknown message type"})}}),"undefined"!=typeof globalThis&&(globalThis.backgroundAPI={callMyScriptAPI:async function(e){try{const t=await chrome.storage.sync.get(["userToken"]),o=await fetch("https://ap-southeast-1.run.claw.cloud/api/ai/myscript",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.userToken}`},body:JSON.stringify({imageData:e})});if(!o.ok)throw new Error(`MyScript API failed: ${o.statusText}`);return await o.json()}catch(e){throw console.error("MyScript识别失败:",e),e}},callDeepseekAPI:async function(e){try{const t=await chrome.storage.sync.get(["userToken"]),o=await fetch("https://ap-southeast-1.run.claw.cloud/api/ai/grading",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.userToken}`},body:JSON.stringify({content:e})});if(!o.ok)throw new Error(`Deepseek API failed: ${o.statusText}`);return await o.json()}catch(e){throw console.error("Deepseek批改失败:",e),e}},handleFileUpload:e,handleSaveSubmission:t})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUJDLE1BQU0sd0RBQXlELENBQ2xGQyxPQUFRLE9BQ1JDLFFBQVMsQ0FDTCxlQUFnQixtQkFDaEIsY0FBaUIsVUFBVVAsRUFBUVEsYUFFdkNDLEtBQU1TLEtBQUtDLFVBQVUsQ0FBRW9DLGdCQUUzQixJQUFLbkQsRUFBU00sR0FDVixNQUFNLElBQUlDLE1BQU0sd0JBQXdCUCxFQUFTUSxjQUVyRCxhQUFhUixFQUFTUyxNQUMxQixDQUNBLE1BQU9DLEdBRUgsTUFEQUMsUUFBUUQsTUFBTSxnQkFBaUJBLEdBQ3pCQSxDQUNWLENBQ0osRUEyQlEwQyxnQkF6QlJoRSxlQUErQmlFLEdBQzNCLElBQ0ksTUFBTXpELFFBQWdCQyxPQUFPRCxRQUFRRSxLQUFLQyxJQUFJLENBQUMsY0FDekNDLFFBQWlCQyxNQUFNLHVEQUF3RCxDQUNqRkMsT0FBUSxPQUNSQyxRQUFTLENBQ0wsZUFBZ0IsbUJBQ2hCLGNBQWlCLFVBQVVQLEVBQVFRLGFBRXZDQyxLQUFNUyxLQUFLQyxVQUFVLENBQUVzQyxjQUUzQixJQUFLckQsRUFBU00sR0FDVixNQUFNLElBQUlDLE1BQU0sd0JBQXdCUCxFQUFTUSxjQUVyRCxhQUFhUixFQUFTUyxNQUMxQixDQUNBLE1BQU9DLEdBRUgsTUFEQUMsUUFBUUQsTUFBTSxnQkFBaUJBLEdBQ3pCQSxDQUNWLENBQ0osRUFNUXJCLG1CQUNBdUIsd0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYWxjdWx1cy1haS1leHRlbnNpb24vLi9zcmMvYmFja2dyb3VuZC9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbi8vIENocm9tZeaPkuS7tlNlcnZpY2UgV29ya2Vy5ZCO5Y+w6ISa5pysXG4vLyDmj5Lku7blronoo4Xml7bliJ3lp4vljJZcbmNocm9tZS5ydW50aW1lLm9uSW5zdGFsbGVkLmFkZExpc3RlbmVyKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnQUnlvq7np6/liIbliqnmlZnmj5Lku7blt7Llronoo4UnKTtcbiAgICAvLyDliJ3lp4vljJblrZjlgqhcbiAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7XG4gICAgICAgIGlzTG9nZ2VkSW46IGZhbHNlLFxuICAgICAgICB1c2VyUHJvZmlsZTogbnVsbCxcbiAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgIGF1dG9HcmFkaW5nOiB0cnVlLFxuICAgICAgICAgICAgc2hvd0hpbnRzOiB0cnVlLFxuICAgICAgICAgICAgbGFuZ3VhZ2U6ICd6aC1DTidcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIC8vIOWIm+W7uuS4iuS4i+aWh+iPnOWNlSAo5aaC5p6cQVBJ5Y+v55SoKVxuICAgIGlmIChjaHJvbWUuY29udGV4dE1lbnVzKSB7XG4gICAgICAgIGNocm9tZS5jb250ZXh0TWVudXMuY3JlYXRlKHtcbiAgICAgICAgICAgIGlkOiAndXBsb2FkSG9tZXdvcmsnLFxuICAgICAgICAgICAgdGl0bGU6ICfkuIrkvKDkvZzkuJrliLBBSeWKqeaVmScsXG4gICAgICAgICAgICBjb250ZXh0czogWydwYWdlJ11cbiAgICAgICAgfSk7XG4gICAgfVxufSk7XG4vLyDkuIrkuIvmlofoj5zljZXngrnlh7vlpITnkIYgKOWmguaenEFQSeWPr+eUqClcbmlmIChjaHJvbWUuY29udGV4dE1lbnVzICYmIGNocm9tZS5jb250ZXh0TWVudXMub25DbGlja2VkKSB7XG4gICAgY2hyb21lLmNvbnRleHRNZW51cy5vbkNsaWNrZWQuYWRkTGlzdGVuZXIoKGluZm8sIHRhYikgPT4ge1xuICAgICAgICBpZiAoaW5mby5tZW51SXRlbUlkID09PSAndXBsb2FkSG9tZXdvcmsnKSB7XG4gICAgICAgICAgICAvLyDmiZPlvIDkvqfovrnmoI9cbiAgICAgICAgICAgIGlmICh0YWI/LmlkICYmIGNocm9tZS5zaWRlUGFuZWwpIHtcbiAgICAgICAgICAgICAgICBjaHJvbWUuc2lkZVBhbmVsLm9wZW4oeyB0YWJJZDogdGFiLmlkIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG4vLyDlpITnkIbmnaXoh6pjb250ZW50IHNjcmlwdOWSjHBvcHVw55qE5raI5oGvXG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKG1lc3NhZ2UsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ0JhY2tncm91bmTmlLbliLDmtojmga86JywgbWVzc2FnZSk7XG4gICAgc3dpdGNoIChtZXNzYWdlLnR5cGUpIHtcbiAgICAgICAgY2FzZSAnVVBMT0FEX0ZJTEUnOlxuICAgICAgICAgICAgaGFuZGxlRmlsZVVwbG9hZChtZXNzYWdlLmRhdGEpXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4gc2VuZFJlc3BvbnNlKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH0pKVxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHNlbmRSZXNwb25zZSh7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTsgLy8g5L+d5oyB5raI5oGv6YCa6YGT5byA5pS+55So5LqO5byC5q2l5ZON5bqUXG4gICAgICAgIGNhc2UgJ0dFVF9VU0VSX1NUQVRVUyc6XG4gICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLmdldChbJ2lzTG9nZ2VkSW4nLCAndXNlclByb2ZpbGUnXSwgKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgIHNlbmRSZXNwb25zZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGNhc2UgJ1NBVkVfU1VCTUlTU0lPTic6XG4gICAgICAgICAgICBoYW5kbGVTYXZlU3VibWlzc2lvbihtZXNzYWdlLmRhdGEpXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4gc2VuZFJlc3BvbnNlKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH0pKVxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHNlbmRSZXNwb25zZSh7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHNlbmRSZXNwb25zZSh7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Vua25vd24gbWVzc2FnZSB0eXBlJyB9KTtcbiAgICB9XG59KTtcbi8vIOaWh+S7tuS4iuS8oOWkhOeQhlxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlRmlsZVVwbG9hZChmaWxlRGF0YSkge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGZpbGVEYXRhLmZpbGUpO1xuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3R5cGUnLCBmaWxlRGF0YS50eXBlKTtcbiAgICAgICAgLy8g6I635Y+W55So5oi3dG9rZW5cbiAgICAgICAgY29uc3Qgc3RvcmFnZSA9IGF3YWl0IGNocm9tZS5zdG9yYWdlLnN5bmMuZ2V0KFsndXNlclRva2VuJ10pO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwLXNvdXRoZWFzdC0xLnJ1bi5jbGF3LmNsb3VkL2FwaS91cGxvYWQnLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtzdG9yYWdlLnVzZXJUb2tlbn1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogZm9ybURhdGFcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVXBsb2FkIGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+aWh+S7tuS4iuS8oOWksei0pTonLCBlcnJvcik7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbn1cbi8vIOS/neWtmOS9nOS4muaPkOS6pFxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlU2F2ZVN1Ym1pc3Npb24oc3VibWlzc2lvbkRhdGEpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBzdG9yYWdlID0gYXdhaXQgY2hyb21lLnN0b3JhZ2Uuc3luYy5nZXQoWyd1c2VyVG9rZW4nXSk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXAtc291dGhlYXN0LTEucnVuLmNsYXcuY2xvdWQvYXBpL3N1Ym1pc3Npb25zJywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtzdG9yYWdlLnVzZXJUb2tlbn1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoc3VibWlzc2lvbkRhdGEpXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNhdmUgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign5L+d5a2Y5L2c5Lia5aSx6LSlOicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxufVxuLy8gTXlTY3JpcHTor4bliKvlpITnkIZcbmFzeW5jIGZ1bmN0aW9uIGNhbGxNeVNjcmlwdEFQSShpbWFnZURhdGEpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBzdG9yYWdlID0gYXdhaXQgY2hyb21lLnN0b3JhZ2Uuc3luYy5nZXQoWyd1c2VyVG9rZW4nXSk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXAtc291dGhlYXN0LTEucnVuLmNsYXcuY2xvdWQvYXBpL2FpL215c2NyaXB0Jywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtzdG9yYWdlLnVzZXJUb2tlbn1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBpbWFnZURhdGEgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTXlTY3JpcHQgQVBJIGZhaWxlZDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdNeVNjcmlwdOivhuWIq+Wksei0pTonLCBlcnJvcik7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbn1cbi8vIERlZXBzZWVrIEFJ5om55pS55aSE55CGXG5hc3luYyBmdW5jdGlvbiBjYWxsRGVlcHNlZWtBUEkoY29udGVudCkge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHN0b3JhZ2UgPSBhd2FpdCBjaHJvbWUuc3RvcmFnZS5zeW5jLmdldChbJ3VzZXJUb2tlbiddKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcC1zb3V0aGVhc3QtMS5ydW4uY2xhdy5jbG91ZC9hcGkvYWkvZ3JhZGluZycsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7c3RvcmFnZS51c2VyVG9rZW59YFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgY29udGVudCB9KVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEZWVwc2VlayBBUEkgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0RlZXBzZWVr5om55pS55aSx6LSlOicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxufVxuLy8g5a+85Ye65L6b5YW25LuW5qih5Z2X5L2/55SoXG5pZiAodHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgZ2xvYmFsVGhpcy5iYWNrZ3JvdW5kQVBJID0ge1xuICAgICAgICBjYWxsTXlTY3JpcHRBUEksXG4gICAgICAgIGNhbGxEZWVwc2Vla0FQSSxcbiAgICAgICAgaGFuZGxlRmlsZVVwbG9hZCxcbiAgICAgICAgaGFuZGxlU2F2ZVN1Ym1pc3Npb25cbiAgICB9O1xufVxuIl0sIm5hbWVzIjpbImFzeW5jIiwiaGFuZGxlRmlsZVVwbG9hZCIsImZpbGVEYXRhIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsImFwcGVuZCIsImZpbGUiLCJ0eXBlIiwic3RvcmFnZSIsImNocm9tZSIsInN5bmMiLCJnZXQiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsInVzZXJUb2tlbiIsImJvZHkiLCJvayIsIkVycm9yIiwic3RhdHVzVGV4dCIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJoYW5kbGVTYXZlU3VibWlzc2lvbiIsInN1Ym1pc3Npb25EYXRhIiwiSlNPTiIsInN0cmluZ2lmeSIsInJ1bnRpbWUiLCJvbkluc3RhbGxlZCIsImFkZExpc3RlbmVyIiwibG9nIiwic2V0IiwiaXNMb2dnZWRJbiIsInVzZXJQcm9maWxlIiwic2V0dGluZ3MiLCJhdXRvR3JhZGluZyIsInNob3dIaW50cyIsImxhbmd1YWdlIiwiY29udGV4dE1lbnVzIiwiY3JlYXRlIiwiaWQiLCJ0aXRsZSIsImNvbnRleHRzIiwib25DbGlja2VkIiwiaW5mbyIsInRhYiIsIm1lbnVJdGVtSWQiLCJzaWRlUGFuZWwiLCJvcGVuIiwidGFiSWQiLCJvbk1lc3NhZ2UiLCJtZXNzYWdlIiwic2VuZGVyIiwic2VuZFJlc3BvbnNlIiwiZGF0YSIsInRoZW4iLCJyZXN1bHQiLCJzdWNjZXNzIiwiY2F0Y2giLCJnbG9iYWxUaGlzIiwiYmFja2dyb3VuZEFQSSIsImNhbGxNeVNjcmlwdEFQSSIsImltYWdlRGF0YSIsImNhbGxEZWVwc2Vla0FQSSIsImNvbnRlbnQiXSwic291cmNlUm9vdCI6IiJ9